<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.5">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="shortcut icon" href="#" type="image/x-icon">
  <link rel="icon" href="#" type="image/x-icon">


 </head>
 <body>
    <!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
    <button id="unmute"> 음악on </button><br><br>
    <div id="player"></div>

	<script type="text/javascript">
var ytbm = new Array;
		
$(function (){
//    fread("skds");
//    fread("trimgs");
    fread("ytbm");
});	
	
function fread(fn){
    $(function (){
	var fileName = '../uni2o4o/' + fn + '.csv';	// 파일 이름

	$.ajax({
		url:fileName,
		headers: {  'Access-Control-Allow-Origin': '../uni_2o4o/' },
		dataType:'text',
		success: function(da) {
			var textLine = '<script type="text/javascript">var ' + fn + '=[';
                        var rows = da.split('\n');
                        for (var i = 0; i < rows.length; i++) {
				if (i == 0){textLine += '['}else{textLine += ',['};
				var cells = rows[i].split(',');
                                for (var j = 0; j < cells.length; j++) {
					textLine += '"';
					textLine += cells[j].trim();;
					if (j == cells.length-1){textLine += '"'}else{textLine += '",'};
				}
				textLine += ']';
			}	
			textLine += ']';			
			$('head').append(textLine);
		}
	});
    });
};

	$(function (){
		setTimeout(musbox(null,5), 2000);
	});


   //--■■■■■■■■■■■■■■■■■음악 __Xplayer.js■■■■■■■■■■■■■■■■■■

var selm = ""; var titlm = ""; var h = '280'; var w = '500';
var seln = "";  var titln = "";

//================ 음악 재생 player ==========
 function musbox(a,b){
	selm = ""; titlm = ""; seln = ""; titln = "";

	if (a==null){a = Math.floor(Math.random() * ytbm.length);}
	selm = ytbm[a][1];
	titlm = ytbm[a][3] +" - "+ ytbm[a][4];
	//	    h = '1';   w = '1';

	if (b==1){seln=selm}
	else{
		for (k=1;k<b ; k++){
			if (k+a==ytbm.length){a=a-ytbm.length;}
				seln=seln+ytbm[k+a][1]+",";
				titln=titln+ytbm[k+a][3] +" - "+ ytbm[k+a][4]+"<br/>";
		}
		seln=seln+ytbm[a+b][1];
		titln=titln+ytbm[k+a][3] +" - "+ ytbm[k+a][4];
	}
 };

//================ 음악 재생 player ==========

	  // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player = "";

      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: h,
          width: w,
          videoId: selm,
          playerVars: {
		  'autoplay': 1                     // 자동재생
		, 'loop' : 1                         // 반복 0 : off, 1 : on
		, 'playlist' : seln                 // 반복 playlist
		, 'mute': 1			  // N.B. here the mute settings.
	  },
          events: {
            'onReady': onPlayerReady,
			'onError' : onPlayerError
          }
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        event.target.playVideo();
      }

	  // Error
	  function onPlayerError(){
	  	  player.nextVideo();
	  };

	  // Unmute
      $('button#unmute').click( function() {
        player.unMute();	      
      });

 </script>
 </body>
</html>
